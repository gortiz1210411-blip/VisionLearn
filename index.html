
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>FL Standards Tracker</title>
<style>
:root{--bg:#0b1020;--card:#121a32;--accent:#6ae3ff}
html,body{margin:0;height:100%;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:var(--bg);color:#e6f0ff}
.container{max-width:1100px;margin:0 auto;padding:16px}
header{display:flex;flex-wrap:wrap;align-items:center;gap:12px;justify-content:space-between;margin-bottom:12px}
.brand{font-weight:800}
.tabs{display:flex;gap:8px;flex-wrap:wrap}
.tab{background:transparent;border:1px solid #243152;border-radius:999px;padding:8px 12px;color:#cfe2ff;cursor:pointer}
.tab.active{background:#243152;color:#fff;border-color:#3a4a74}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
.card{background:#121a32;border-radius:16px;padding:12px;box-shadow:0 10px 30px rgba(0,0,0,.25);border:1px solid #1c2746}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
input,select,textarea,button{background:#0d152b;color:#e6f0ff;border:1px solid #203055;border-radius:10px;padding:8px 10px;font-size:14px;outline:none}
textarea{min-height:70px;width:100%}
.pill{border-radius:999px;padding:2px 8px;border:1px solid #203055;color:#cfe2ff}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border-bottom:1px solid #1e2a49;padding:8px 6px;text-align:left;vertical-align:top}
th{position:sticky;top:0;background:#0f1832;z-index:1}
.subtle{font-size:12px;color:#93a4c7}
.rating button{cursor:pointer}
</style>
<link rel="manifest" href="manifest.webmanifest">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FL Standards">
<link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>
<div class="container">
<header>
  <div class="row">
    <span class="brand">FL Standards Tracker</span>
    <span class="pill">1–5 scale</span>
    <span class="pill">Notes</span>
    <span class="pill">CSV export</span>
  </div>
  <div class="tabs" id="subjectTabs"></div>
</header>

<div class="grid">
  <section class="card">
    <h3 style="margin-top:0">1) Add/Import Students</h3>
    <div class="row" style="gap:6px;margin-bottom:8px">
      <input id="studentName" placeholder="Student name"/>
      <input id="studentId" placeholder="Student ID (optional)"/>
      <button onclick="addStudent()">Add</button>
      <span class="subtle">Bulk import: CSV with columns <b>name</b>, <b>id</b> (optional).</span>
    </div>
    <div class="row" style="gap:6px;margin-bottom:8px">
      <input type="file" id="studentCSV" accept=".csv"/>
      <button onclick="importStudents()">Import CSV</button>
      <button style="background:#2a0e12;border-color:#5e1921" onclick="clearStudents()">Clear students</button>
    </div>
    <div id="studentList" class="subtle"></div>
  </section>

  <section class="card">
    <h3 style="margin-top:0">2) Choose Standard & Rate</h3>
    <div class="row" style="gap:6px;margin-bottom:8px">
      <select id="studentSelect"></select>
      <select id="standardSelect"></select>
      <input class="search" id="standardSearch" placeholder="Search standards..." oninput="renderStandards()"/>
    </div>
    <div class="row" style="gap:12px;margin-bottom:8px">
      <div class="rating" id="ratingGroup"></div>
      <input id="dateInput" type="date"/>
      <span class="subtle">5 = Proficient · 1 = Not proficient</span>
      <span style="margin-left:auto"></span>
      <button onclick="quickSave()">Save</button>
    </div>
    <textarea id="notes" placeholder="Notes / evidence / accommodations..."></textarea>
  </section>

  <section class="card" style="grid-column:1/-1">
    <div class="row" style="gap:6px">
      <h3 style="margin:0">3) Records</h3>
      <span style="margin-left:auto"></span>
      <button onclick="exportCSV()">Export CSV</button>
      <button onclick="exportStandards()">Export Standards CSV</button>
      <button style="background:#2a0e12;border-color:#5e1921" onclick="wipeRecords()">Delete All</button>
    </div>
    <div class="row" style="gap:6px;margin:8px 0;">
      <input id="filterStudent" placeholder="Filter by student..." oninput="renderTable()"/>
      <input id="filterCode" placeholder="Filter by code..." oninput="renderTable()"/>
      <select id="filterSubject" onchange="renderTable()"></select>
      <select id="filterRating" onchange="renderTable()">
        <option value="">All ratings</option>
        <option value="5">5</option><option value="4">4</option>
        <option value="3">3</option><option value="2">2</option><option value="1">1</option>
      </select>
    </div>
    <div style="max-height:380px;overflow:auto">
      <table id="dataTable"><thead><tr>
        <th>Date</th><th>Student</th><th>Subject</th><th>Code</th><th>Standard</th><th>Rating</th><th>Notes</th><th></th>
      </tr></thead><tbody></tbody></table>
    </div>
    <div class="subtle">Saved locally on this device (localStorage). Export regularly to back up.</div>
  </section>
</div>
</div>

<script>
const RATING_LABELS = {1:'Not proficient',2:'Progressing',3:'Approaching',4:'On track',5:'Proficient'};
let SUBJECTS = [];
let STANDARDS = {"meta": {"last_updated": "2025-08-14"}, "ELA": [{"code": "ELA.5.F.1.3", "desc": "Decode using letter-sound, syllabication, morphology."}, {"code": "ELA.5.F.1.4", "desc": "Read grade-level texts with accuracy/automaticity/prosody."}, {"code": "ELA.5.R.1.1", "desc": "Analyze how setting, events, conflict, characterization contribute to plot."}, {"code": "ELA.5.R.1.2", "desc": "Explain development of stated or implied theme(s)."}, {"code": "ELA.5.R.1.3", "desc": "Describe how an author develops a character\u2019s perspective."}, {"code": "ELA.5.R.1.4", "desc": "Explain how figurative language and poetic elements work together in a poem."}, {"code": "ELA.5.R.2.1", "desc": "Explain how text structures/features contribute to overall meaning."}, {"code": "ELA.5.R.2.2", "desc": "Explain how relevant details support central idea(s)."}, {"code": "ELA.5.R.2.3", "desc": "Analyze author\u2019s purpose and/or perspective in informational text."}, {"code": "ELA.5.R.2.4", "desc": "Track development of an argument: claims, evidence, reasoning."}, {"code": "ELA.5.R.3.1", "desc": "Analyze how figurative language contributes to meaning."}, {"code": "ELA.5.R.3.2", "desc": "Summarize a text."}, {"code": "ELA.5.R.3.3", "desc": "Compare and contrast primary and secondary sources on same topic."}, {"code": "ELA.5.C.1.2", "desc": "Write narratives with logical sequence, dialogue/description/transitions."}, {"code": "ELA.5.C.1.3", "desc": "Write claims with reasons and relevant evidence."}, {"code": "ELA.5.C.1.4", "desc": "Write expository texts using multiple sources."}, {"code": "ELA.5.C.3.1", "desc": "Follow rules of standard English."}, {"code": "ELA.5.V.1.2", "desc": "Apply knowledge of Greek/Latin roots and affixes."}], "Math": [{"code": "MA.5.NSO.2.1", "desc": "Multiply multi-digit whole numbers (standard algorithm)."}, {"code": "MA.5.NSO.2.2", "desc": "Divide multi-digit whole numbers (up to 5 digits by 2 digits)."}, {"code": "MA.5.NSO.2.3", "desc": "Add/subtract multi-digit decimals to thousandths (fluency)."}, {"code": "MA.5.FR.2.1", "desc": "Add and subtract fractions with unlike denominators."}, {"code": "MA.5.FR.2.2", "desc": "Multiply a fraction by a fraction (incl. mixed numbers)."}, {"code": "MA.5.AR.2.2", "desc": "Evaluate multi-step numerical expressions (order of operations)."}, {"code": "MA.5.GR.3.1", "desc": "Explore volume using unit cubes; count cubes."}, {"code": "MA.5.GR.3.2", "desc": "Volume of right rectangular prism using formula."}, {"code": "MA.5.DP.1.2", "desc": "Interpret data to find mean, mode, median, range."}], "Science": [{"code": "SC.5.N.2.1", "desc": "Science is grounded in testable, evidence-linked observations."}, {"code": "SC.5.E.7.1", "desc": "Model parts of the water cycle."}, {"code": "SC.5.E.7.3", "desc": "Weather variables: temperature, pressure, humidity, wind, precipitation."}, {"code": "SC.5.P.10.1", "desc": "Light travels in straight lines; reflect/refract/absorb."}, {"code": "SC.5.P.11.1", "desc": "Flow of electricity requires a closed circuit."}, {"code": "SC.5.P.13.1", "desc": "Identify familiar forces (gravity, magnetism, friction)."}, {"code": "SC.5.L.14.1", "desc": "Identify human organs and describe functions."}]};
let STUDENTS = JSON.parse(localStorage.getItem('fl_students')||'[]');
let RECORDS = JSON.parse(localStorage.getItem('fl_records')||'[]');
let currentSubject = 'ELA';

const subjectTabs = document.getElementById('subjectTabs');
const studentSelect = document.getElementById('studentSelect');
const standardSelect = document.getElementById('standardSelect');
const ratingGroup = document.getElementById('ratingGroup');
const dateInput = document.getElementById('dateInput');
const notesEl = document.getElementById('notes');
const filterSubject = document.getElementById('filterSubject');

function setDateToday(){ const d=new Date(); dateInput.value=d.toISOString().slice(0,10); }
setDateToday();

function initRatings(){
  ratingGroup.innerHTML='';
  for(let i=1;i<=5;i++){
    const b=document.createElement('button');
    b.textContent=i+' – '+RATING_LABELS[i];
    b.onclick=()=>{ document.querySelectorAll('.rating button').forEach(x=>x.style.borderColor='#203055'); b.style.borderColor='var(--accent)'; ratingGroup.dataset.value=i; };
    ratingGroup.appendChild(b);
  }
}
initRatings();

function renderStudents(){
  studentSelect.innerHTML = '<option value="">Select student…</option>' + STUDENTS.map((s,i)=>`<option value="${i}">${s.name}${s.id?(" ("+s.id+")"):""}</option>`).join('');
  document.getElementById('studentList').textContent = STUDENTS.length ? STUDENTS.map(s=>s.name).join(', ') : 'No students added yet';
  localStorage.setItem('fl_students', JSON.stringify(STUDENTS));
}
renderStudents();

function addStudent(){ const name=document.getElementById('studentName').value.trim(); const id=document.getElementById('studentId').value.trim(); if(!name) return alert('Enter a student name'); STUDENTS.push({name,id}); document.getElementById('studentName').value=''; document.getElementById('studentId').value=''; renderStudents(); }
function clearStudents(){ if(!confirm('Delete all students?')) return; STUDENTS=[]; renderStudents(); }
async function importStudents(){ const f=document.getElementById('studentCSV').files[0]; if(!f) return alert('Choose a CSV'); const t=await f.text(); const rows=t.split(/\r?\n/).filter(Boolean); const headers=rows[0].split(',').map(h=>h.trim().toLowerCase()); const nameIdx=headers.indexOf('name'); const idIdx=headers.indexOf('id'); if(nameIdx===-1) return alert('CSV must have a "name" column'); for(let i=1;i<rows.length;i++){ const cols=rows[i].split(','); const name=(cols[nameIdx]||'').trim(); if(!name) continue; const id=idIdx>-1?(cols[idIdx]||'').trim():''; STUDENTS.push({name,id}); } renderStudents(); }

function renderTabs(){
  subjectTabs.innerHTML='';
  SUBJECTS.forEach(s=>{
    const b=document.createElement('button');
    b.className='tab'+(s===currentSubject?' active':'');
    b.textContent=s;
    b.onclick=()=>{ currentSubject=s; renderTabs(); renderStandards(); filterSubject.value=s; renderTable(); };
    subjectTabs.appendChild(b);
  });
}
function renderStandards(){
  const search=document.getElementById('standardSearch').value.toLowerCase();
  const list=STANDARDS[currentSubject]||[];
  const options=list.filter(x=>(x.code+' '+x.desc).toLowerCase().includes(search)).map(x=>`<option value="${x.code}">${x.code} — ${x.desc}</option>`).join('');
  standardSelect.innerHTML = '<option value="">Select standard…</option>' + options;
}

function quickSave(){
  const studentIdx=studentSelect.value;
  if(studentIdx==='') return alert('Select a student');
  const code=standardSelect.value;
  if(!code) return alert('Select a standard');
  const rating=parseInt(ratingGroup.dataset.value||'0',10);
  if(!rating) return alert('Pick a rating (1–5)');
  const note=notesEl.value.trim();
  const std=(STANDARDS[currentSubject]||[]).find(s=>s.code===code);
  const record={date:dateInput.value||new Date().toISOString().slice(0,10),student:STUDENTS[studentIdx].name,student_id:STUDENTS[studentIdx].id||'',subject:currentSubject,code,standard:std?std.desc:'',rating,notes:note};
  RECORDS.push(record);
  localStorage.setItem('fl_records', JSON.stringify(RECORDS));
  notesEl.value='';
  document.querySelectorAll('.rating button').forEach(x=>x.style.borderColor='#203055');
  ratingGroup.dataset.value='';
  renderTable();
}

function renderTable(){
  const tbody=document.querySelector('#dataTable tbody');
  const fs=document.getElementById('filterStudent').value.toLowerCase();
  const fc=document.getElementById('filterCode').value.toLowerCase();
  const fsubj=document.getElementById('filterSubject').value;
  const fr=document.getElementById('filterRating').value;
  const rows=RECORDS
    .filter(r=>(!fs||r.student.toLowerCase().includes(fs)))
    .filter(r=>(!fc||(r.code+' '+r.standard).toLowerCase().includes(fc)))
    .filter(r=>(!fsubj||r.subject===fsubj))
    .filter(r=>(!fr||String(r.rating)===fr));
  tbody.innerHTML = rows.map((r,idx)=>`<tr><td>${r.date}</td><td>${r.student}</td><td>${r.subject}</td><td><span class='pill'>${r.code}</span></td><td>${r.standard}</td><td><b>${r.rating}</b></td><td>${r.notes||''}</td><td><button onclick='delRecord(${idx})'>✕</button></td></tr>`).join('');
  localStorage.setItem('fl_records', JSON.stringify(RECORDS));
}
function delRecord(idx){
  if(!confirm('Delete this record?')) return;
  const fs=document.getElementById('filterStudent').value.toLowerCase();
  const fc=document.getElementById('filterCode').value.toLowerCase();
  const fsubj=document.getElementById('filterSubject').value;
  const fr=document.getElementById('filterRating').value;
  const filtered=RECORDS.map((r,i)=>({r,i}))
    .filter(x=>(!fs||x.r.student.toLowerCase().includes(fs)))
    .filter(x=>(!fc||(x.r.code+' '+x.r.standard).toLowerCase().includes(fc)))
    .filter(x=>(!fsubj||x.r.subject===fsubj))
    .filter(x=>(!fr||String(x.r.rating)===fr));
  const realIndex=filtered[idx].i;
  RECORDS.splice(realIndex,1);
  renderTable();
}
function wipeRecords(){ if(!confirm('Delete ALL records?')) return; RECORDS=[]; renderTable(); }
function exportCSV(){
  const header=['date','student','student_id','subject','code','standard','rating','notes'];
  const lines=[header.join(',')].concat(RECORDS.map(r=>header.map(h=>'"'+String(r[h]||'').replace(/"/g,'""')+'"' ).join(',')));
  const blob=new Blob([lines.join('\n')],{type:'text/csv'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='fl-standards-tracker-records.csv'; a.click();
}
function exportStandards(){
  const rows=[['subject','code','desc']];
  for(const subj of SUBJECTS){ for(const s of STANDARDS[subj]||[]){ rows.push([subj,s.code,s.desc]); } }
  const lines=rows.map(c=>c.map(v=>'"'+String(v).replace(/"/g,'""')+'"' ).join(',')).join('\n');
  const blob=new Blob([lines],{type:'text/csv'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='fl-standards-list.csv'; a.click();
}
function loadStandards(){
  const data=STANDARDS;
  SUBJECTS=Object.keys(data).filter(k=>k!=='meta');
  STANDARDS={ELA:STANDARDS.ELA, Math:STANDARDS.Math, Science:STANDARDS.Science};
  filterSubject.innerHTML='<option value="">All subjects</option>'+SUBJECTS.map(s=>`<option>${s}</option>`).join('');
  currentSubject=SUBJECTS[0];
  renderTabs(); renderStandards(); renderTable();
}
loadStandards();
</script>
<script>if('serviceWorker' in navigator){window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js'));}</script>
</body>
</html>
